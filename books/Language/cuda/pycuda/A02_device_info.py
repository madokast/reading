# -*- coding: utf-8 -*-
"""
Created on Sun Aug 12 11:29:01 2018
@author: bhaumik
"""

import pycuda.driver as drv
import pycuda.autoinit

drv.init()
print("%d device(s) found." % drv.Device.count())
for i in range(drv.Device.count()):
    dev = drv.Device(i)
    print("Device #%d: %s" % (i, dev.name()))
    print("  Compute Capability: %d.%d" % dev.compute_capability())
    print("  Total Memory: %s GB" % (dev.total_memory() // (1024 * 1024 * 1024)))
    attributes = [
        (str(prop), value) for prop, value in list(dev.get_attributes().items())
    ]
    attributes.sort()
    n = 0
    for prop, value in attributes:
        print("  %s: %s " % (prop, value), end=" ")
        n = n + 1
        if n % 2 == 0:
            print(" ")

print(
    drv.Device(0).get_attributes()[pycuda._driver.device_attribute.MULTIPROCESSOR_COUNT]
)

"""
3070 参数
1 device(s) found.
Device #0: GeForce RTX 3070
  Compute Capability: 8.6
  Total Memory: 8 GB
  ASYNC_ENGINE_COUNT: 2    CAN_MAP_HOST_MEMORY: 1
  CLOCK_RATE: 1725000    COMPUTE_CAPABILITY_MAJOR: 8
  COMPUTE_CAPABILITY_MINOR: 6    COMPUTE_MODE: DEFAULT
  CONCURRENT_KERNELS: 1    ECC_ENABLED: 0
  GLOBAL_L1_CACHE_SUPPORTED: 1    GLOBAL_MEMORY_BUS_WIDTH: 256
  GPU_OVERLAP: 1    INTEGRATED: 0
  KERNEL_EXEC_TIMEOUT: 1    L2_CACHE_SIZE: 4194304
  LOCAL_L1_CACHE_SUPPORTED: 1    MANAGED_MEMORY: 1
  MAXIMUM_SURFACE1D_LAYERED_LAYERS: 2048    MAXIMUM_SURFACE1D_LAYERED_WIDTH: 32768
  MAXIMUM_SURFACE1D_WIDTH: 32768    MAXIMUM_SURFACE2D_HEIGHT: 65536
  MAXIMUM_SURFACE2D_LAYERED_HEIGHT: 32768    MAXIMUM_SURFACE2D_LAYERED_LAYERS: 2048
  MAXIMUM_SURFACE2D_LAYERED_WIDTH: 32768    MAXIMUM_SURFACE2D_WIDTH: 131072
  MAXIMUM_SURFACE3D_DEPTH: 16384    MAXIMUM_SURFACE3D_HEIGHT: 16384
  MAXIMUM_SURFACE3D_WIDTH: 16384    MAXIMUM_SURFACECUBEMAP_LAYERED_LAYERS: 2046
  MAXIMUM_SURFACECUBEMAP_LAYERED_WIDTH: 32768    MAXIMUM_SURFACECUBEMAP_WIDTH: 32768
  MAXIMUM_TEXTURE1D_LAYERED_LAYERS: 2048    MAXIMUM_TEXTURE1D_LAYERED_WIDTH: 32768
  MAXIMUM_TEXTURE1D_LINEAR_WIDTH: 268435456    MAXIMUM_TEXTURE1D_MIPMAPPED_WIDTH: 32768
  MAXIMUM_TEXTURE1D_WIDTH: 131072    MAXIMUM_TEXTURE2D_ARRAY_HEIGHT: 32768
  MAXIMUM_TEXTURE2D_ARRAY_NUMSLICES: 2048    MAXIMUM_TEXTURE2D_ARRAY_WIDTH: 32768
  MAXIMUM_TEXTURE2D_GATHER_HEIGHT: 32768    MAXIMUM_TEXTURE2D_GATHER_WIDTH: 32768
  MAXIMUM_TEXTURE2D_HEIGHT: 65536    MAXIMUM_TEXTURE2D_LINEAR_HEIGHT: 65000
  MAXIMUM_TEXTURE2D_LINEAR_PITCH: 2097120    MAXIMUM_TEXTURE2D_LINEAR_WIDTH: 131072
  MAXIMUM_TEXTURE2D_MIPMAPPED_HEIGHT: 32768    MAXIMUM_TEXTURE2D_MIPMAPPED_WIDTH: 32768
  MAXIMUM_TEXTURE2D_WIDTH: 131072    MAXIMUM_TEXTURE3D_DEPTH: 16384
  MAXIMUM_TEXTURE3D_DEPTH_ALTERNATE: 32768    MAXIMUM_TEXTURE3D_HEIGHT: 16384
  MAXIMUM_TEXTURE3D_HEIGHT_ALTERNATE: 8192    MAXIMUM_TEXTURE3D_WIDTH: 16384
  MAXIMUM_TEXTURE3D_WIDTH_ALTERNATE: 8192    MAXIMUM_TEXTURECUBEMAP_LAYERED_LAYERS: 2046
  MAXIMUM_TEXTURECUBEMAP_LAYERED_WIDTH: 32768    MAXIMUM_TEXTURECUBEMAP_WIDTH: 32768
  MAX_BLOCK_DIM_X: 1024    MAX_BLOCK_DIM_Y: 1024
  MAX_BLOCK_DIM_Z: 64    MAX_GRID_DIM_X: 2147483647
  MAX_GRID_DIM_Y: 65535    MAX_GRID_DIM_Z: 65535
  MAX_PITCH: 2147483647    MAX_REGISTERS_PER_BLOCK: 65536
  MAX_REGISTERS_PER_MULTIPROCESSOR: 65536    MAX_SHARED_MEMORY_PER_BLOCK: 49152
  MAX_SHARED_MEMORY_PER_MULTIPROCESSOR: 102400    MAX_THREADS_PER_BLOCK: 1024
  MAX_THREADS_PER_MULTIPROCESSOR: 1536    MEMORY_CLOCK_RATE: 7001000
  MULTIPROCESSOR_COUNT: 46    MULTI_GPU_BOARD: 0
  MULTI_GPU_BOARD_GROUP_ID: 0    PCI_BUS_ID: 1
  PCI_DEVICE_ID: 0    PCI_DOMAIN_ID: 0
  STREAM_PRIORITIES_SUPPORTED: 1    SURFACE_ALIGNMENT: 512
  TCC_DRIVER: 0    TEXTURE_ALIGNMENT: 512
  TEXTURE_PITCH_ALIGNMENT: 32    TOTAL_CONSTANT_MEMORY: 65536
  UNIFIED_ADDRESSING: 1    WARP_SIZE: 32
"""

# 3090
"""
1 device(s) found.
Device #0: GeForce RTX 3090
  Compute Capability: 8.6
  Total Memory: 23 GB
  ASYNC_ENGINE_COUNT: 2    CAN_MAP_HOST_MEMORY: 1   
  CLOCK_RATE: 1695000    COMPUTE_CAPABILITY_MAJOR: 8   
  COMPUTE_CAPABILITY_MINOR: 6    COMPUTE_MODE: DEFAULT   
  CONCURRENT_KERNELS: 1    ECC_ENABLED: 0   
  GLOBAL_L1_CACHE_SUPPORTED: 1    GLOBAL_MEMORY_BUS_WIDTH: 384   
  GPU_OVERLAP: 1    INTEGRATED: 0   
  KERNEL_EXEC_TIMEOUT: 1    L2_CACHE_SIZE: 6291456   
  LOCAL_L1_CACHE_SUPPORTED: 1    MANAGED_MEMORY: 1   
  MAXIMUM_SURFACE1D_LAYERED_LAYERS: 2048    MAXIMUM_SURFACE1D_LAYERED_WIDTH: 32768   
  MAXIMUM_SURFACE1D_WIDTH: 32768    MAXIMUM_SURFACE2D_HEIGHT: 65536   
  MAXIMUM_SURFACE2D_LAYERED_HEIGHT: 32768    MAXIMUM_SURFACE2D_LAYERED_LAYERS: 2048   
  MAXIMUM_SURFACE2D_LAYERED_WIDTH: 32768    MAXIMUM_SURFACE2D_WIDTH: 131072   
  MAXIMUM_SURFACE3D_DEPTH: 16384    MAXIMUM_SURFACE3D_HEIGHT: 16384   
  MAXIMUM_SURFACE3D_WIDTH: 16384    MAXIMUM_SURFACECUBEMAP_LAYERED_LAYERS: 2046   
  MAXIMUM_SURFACECUBEMAP_LAYERED_WIDTH: 32768    MAXIMUM_SURFACECUBEMAP_WIDTH: 32768   
  MAXIMUM_TEXTURE1D_LAYERED_LAYERS: 2048    MAXIMUM_TEXTURE1D_LAYERED_WIDTH: 32768   
  MAXIMUM_TEXTURE1D_LINEAR_WIDTH: 268435456    MAXIMUM_TEXTURE1D_MIPMAPPED_WIDTH: 32768   
  MAXIMUM_TEXTURE1D_WIDTH: 131072    MAXIMUM_TEXTURE2D_ARRAY_HEIGHT: 32768   
  MAXIMUM_TEXTURE2D_ARRAY_NUMSLICES: 2048    MAXIMUM_TEXTURE2D_ARRAY_WIDTH: 32768   
  MAXIMUM_TEXTURE2D_GATHER_HEIGHT: 32768    MAXIMUM_TEXTURE2D_GATHER_WIDTH: 32768   
  MAXIMUM_TEXTURE2D_HEIGHT: 65536    MAXIMUM_TEXTURE2D_LINEAR_HEIGHT: 65000   
  MAXIMUM_TEXTURE2D_LINEAR_PITCH: 2097120    MAXIMUM_TEXTURE2D_LINEAR_WIDTH: 131072   
  MAXIMUM_TEXTURE2D_MIPMAPPED_HEIGHT: 32768    MAXIMUM_TEXTURE2D_MIPMAPPED_WIDTH: 32768   
  MAXIMUM_TEXTURE2D_WIDTH: 131072    MAXIMUM_TEXTURE3D_DEPTH: 16384   
  MAXIMUM_TEXTURE3D_DEPTH_ALTERNATE: 32768    MAXIMUM_TEXTURE3D_HEIGHT: 16384   
  MAXIMUM_TEXTURE3D_HEIGHT_ALTERNATE: 8192    MAXIMUM_TEXTURE3D_WIDTH: 16384   
  MAXIMUM_TEXTURE3D_WIDTH_ALTERNATE: 8192    MAXIMUM_TEXTURECUBEMAP_LAYERED_LAYERS: 2046   
  MAXIMUM_TEXTURECUBEMAP_LAYERED_WIDTH: 32768    MAXIMUM_TEXTURECUBEMAP_WIDTH: 32768   
  MAX_BLOCK_DIM_X: 1024    MAX_BLOCK_DIM_Y: 1024   
  MAX_BLOCK_DIM_Z: 64    MAX_GRID_DIM_X: 2147483647   
  MAX_GRID_DIM_Y: 65535    MAX_GRID_DIM_Z: 65535   
  MAX_PITCH: 2147483647    MAX_REGISTERS_PER_BLOCK: 65536   
  MAX_REGISTERS_PER_MULTIPROCESSOR: 65536    MAX_SHARED_MEMORY_PER_BLOCK: 49152   
  MAX_SHARED_MEMORY_PER_MULTIPROCESSOR: 102400    MAX_THREADS_PER_BLOCK: 1024   
  MAX_THREADS_PER_MULTIPROCESSOR: 1536    MEMORY_CLOCK_RATE: 9751000   
  MULTIPROCESSOR_COUNT: 82    MULTI_GPU_BOARD: 0   
  MULTI_GPU_BOARD_GROUP_ID: 0    PCI_BUS_ID: 1   
  PCI_DEVICE_ID: 0    PCI_DOMAIN_ID: 0   
  STREAM_PRIORITIES_SUPPORTED: 1    SURFACE_ALIGNMENT: 512   
  TCC_DRIVER: 0    TEXTURE_ALIGNMENT: 512   
  TEXTURE_PITCH_ALIGNMENT: 32    TOTAL_CONSTANT_MEMORY: 65536   
  UNIFIED_ADDRESSING: 1    WARP_SIZE: 32   
"""